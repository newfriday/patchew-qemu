# -*- Mode: Python -*-
# vim: filetype=python
#
# This work is licensed under the terms of the GNU GPL, version 2 or later.
# See the COPYING file in the top-level directory.

##
# @QCryptodevBackendAlgType:
#
# The supported algorithm types of a crypto device.
#
# @sym: symmetric encryption
# @asym: asymmetric Encryption
#
# Since: 8.0
##
{ 'enum': 'QCryptodevBackendAlgType',
  'prefix': 'QCRYPTODEV_BACKEND_ALG',
  'data': ['sym', 'asym']}

##
# @QCryptodevBackendServiceType:
#
# The supported service types of a crypto device.
#
# Since: 8.0
##
{ 'enum': 'QCryptodevBackendServiceType',
  'prefix': 'QCRYPTODEV_BACKEND_SERVICE',
  'data': ['cipher', 'hash', 'mac', 'aead', 'akcipher']}

##
# @QCryptodevBackendType:
#
# The crypto device backend type
#
# @builtin: the QEMU builtin support
# @vhost-user: vhost-user
# @lkcf: Linux kernel cryptographic framework
#
# Since: 8.0
##
{ 'enum': 'QCryptodevBackendType',
  'prefix': 'QCRYPTODEV_BACKEND_TYPE',
  'data': ['builtin', 'vhost-user', 'lkcf']}

##
# @CryptodevBackendClient:
#
# Information about a queue of crypto device.
#
# @type: the type of the crypto device
#
# @info: the additional infomation of the crypto device
#
# Since: 8.0
##
{ 'struct': 'CryptodevBackendClient',
  'data': { 'queue': 'int',
            'type': 'QCryptodevBackendType',
            '*info': 'str' } }

##
# @QCryptodevBackendSymStat:
#
# The statistics of symmetric operation.
#
# @encrypt-ops: the operations of symmetric encryption
#
# @decrypt-ops: the operations of symmetric decryption
#
# @encrypt-bytes: the bytes of symmetric encryption
#
# @decrypt-bytes: the bytes of symmetric decryption
#
# Since: 8.0
##
{ 'struct': 'QCryptodevBackendSymStat',
  'data': { 'encrypt-ops': 'int',
            'decrypt-ops': 'int',
            'encrypt-bytes': 'int',
            'decrypt-bytes': 'int' } }

##
# @QCryptodevBackendAsymStat:
#
# The statistics of asymmetric operation.
#
# @encrypt-ops: the operations of asymmetric encryption
#
# @decrypt-ops: the operations of asymmetric decryption
#
# @sign-ops: the operations of asymmetric signature
#
# @verify-ops: the operations of asymmetric verification
#
# @encrypt-bytes: the bytes of asymmetric encryption
#
# @decrypt-bytes: the bytes of asymmetric decryption
#
# @sign-bytes: the bytes of asymmetric signature
#
# @verify-bytes: the bytes of asymmetric verification
#
# Since: 8.0
##
{ 'struct': 'QCryptodevBackendAsymStat',
  'data': { 'encrypt-ops': 'int',
            'decrypt-ops': 'int',
            'sign-ops': 'int',
            'verify-ops': 'int',
            'encrypt-bytes': 'int',
            'decrypt-bytes': 'int',
            'sign-bytes': 'int',
            'verify-bytes': 'int' } }

##
# @CryptodevInfo:
#
# Information about a crypto device.
#
# @service: supported service types of a crypto device
#
# @client: the additional infomation of the crypto device
#
# Since: 8.0
##
{ 'struct': 'CryptodevInfo',
  'data': { 'id': 'str',
            'service': ['QCryptodevBackendServiceType'],
            'client': ['CryptodevBackendClient'],
            '*sym-stat': 'QCryptodevBackendSymStat',
            '*asym-stat': 'QCryptodevBackendAsymStat' } }

##
# @query-cryptodev:
#
# Returns information about current crypto devices.
#
# Returns: a list of @CryptodevInfo
#
# Since: 8.0
##
{ 'command': 'query-cryptodev', 'returns': ['CryptodevInfo']}
